{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Magic Four Squared Puzzle",
  "description": "Schema for a 4x4 magic square word puzzle with riddles",
  "type": "object",
  "required": ["puzzleId", "version", "language", "direction", "grid", "words", "riddles", "metadata"],
  "properties": {
    "puzzleId": {
      "type": "string",
      "description": "Unique identifier for the puzzle (UUID)",
      "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
    },
    "version": {
      "type": "string",
      "description": "Schema version (semver)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "language": {
      "type": "string",
      "description": "ISO 639-1 language code",
      "pattern": "^[a-z]{2}$"
    },
    "direction": {
      "type": "string",
      "description": "Text direction",
      "enum": ["ltr", "rtl"]
    },
    "grid": {
      "type": "array",
      "description": "4x4 grid of characters",
      "minItems": 4,
      "maxItems": 4,
      "items": {
        "type": "array",
        "minItems": 4,
        "maxItems": 4,
        "items": {
          "type": "string",
          "minLength": 1,
          "maxLength": 1
        }
      }
    },
    "words": {
      "type": "array",
      "description": "The 4 words that form the magic square",
      "minItems": 4,
      "maxItems": 4,
      "items": {
        "type": "string",
        "minLength": 4,
        "maxLength": 4
      }
    },
    "riddles": {
      "type": "array",
      "description": "Riddles for each word",
      "minItems": 4,
      "maxItems": 4,
      "items": {
        "type": "object",
        "required": ["id", "prompt", "answer", "solutionWord", "position"],
        "properties": {
          "id": {
            "type": "integer",
            "description": "Riddle identifier (1-4)",
            "minimum": 1,
            "maximum": 4
          },
          "prompt": {
            "type": "string",
            "description": "The riddle text",
            "minLength": 1
          },
          "answer": {
            "type": "string",
            "description": "The answer to the riddle (appears in the grid)",
            "minLength": 4,
            "maxLength": 4
          },
          "position": {
            "type": "integer",
            "description": "Row/column index (0-3)",
            "minimum": 0,
            "maximum": 3
          },
          "hint": {
            "type": "string",
            "description": "Optional hint to help solve the riddle"
          },
          "explanation": {
            "type": "string",
            "description": "Optional explanation of why the answer is correct"
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "required": ["createdAt", "difficulty"],
      "properties": {
        "createdAt": {
          "type": "string",
          "description": "ISO 8601 timestamp",
          "format": "date-time"
        },
        "difficulty": {
          "type": "string",
          "description": "Puzzle difficulty level",
          "enum": ["easy", "medium", "hard"]
        }
      }
    }
  }
}
